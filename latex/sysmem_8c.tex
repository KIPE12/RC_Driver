\doxysection{C:\+/\+\+Users/\+\+USER/\+\+One\+Drive/\+\+Desktop/\+doxygen/\+\+RC\+\_\+\+DRIVER/\+sysmem.c 파일 참조}
\hypertarget{sysmem_8c}{}\label{sysmem_8c}\index{C:/Users/USER/OneDrive/Desktop/doxygen/RC\_DRIVER/sysmem.c@{C:/Users/USER/OneDrive/Desktop/doxygen/RC\_DRIVER/sysmem.c}}


Newlib 힙 메모리 할당 저수준 구현 모듈  


{\ttfamily \+\#include $<$errno.\+h$>$}\newline
{\ttfamily \+\#include $<$stdint.\+h$>$}\newline
sysmem.\+c에 대한 include 의존 그래프
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{sysmem_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{함수}
\begin{DoxyCompactItemize}
\item 
void \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{sysmem_8c_a68125648bcce70b6bb3aa0be50e99700}{\+\_\+sbrk}} (ptrdiff\+\_\+t incr)
\begin{DoxyCompactList}\small\item\em \doxylink{sysmem_8c_a68125648bcce70b6bb3aa0be50e99700}{\+\_\+sbrk()} allocates memory to the newlib heap and is used by malloc and others from the C library \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{변수}
\begin{DoxyCompactItemize}
\item 
static uint8\+\_\+t \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{sysmem_8c_a2cf862d604e9c7cfcf0528a0f539a6a5}{\+\_\+\+\_\+sbrk\+\_\+heap\+\_\+end}} = NULL
\end{DoxyCompactItemize}


\doxysubsection{상세한 설명}
Newlib 힙 메모리 할당 저수준 구현 모듈 

malloc() 등 C 표준 라이브러리 동적 메모리 함수가 내부적으로 호출하는 \doxylink{sysmem_8c_a68125648bcce70b6bb3aa0be50e99700}{\+\_\+sbrk()} 함수를 구현한다.

메모리 레이아웃:\+ \begin{DoxyVerb}* ############################################################################
* #  .data  #  .bss  #       newlib heap       #          MSP stack          #
* #         #        #                         # Reserved by _Min_Stack_Size #
* ############################################################################
* ^-- RAM start      ^-- _end                             _estack, RAM end --^
* \end{DoxyVerb}


\doxylink{sysmem_8c_a68125648bcce70b6bb3aa0be50e99700}{\+\_\+sbrk()} 동작:\+
\begin{DoxyItemize}
\item 첫 호출 시 힙 시작 주소를 링커 심볼 \+\_\+end로 초기화
\item 힙이 MSP 스택 예약 영역(\+\_\+estack -\/ \+\_\+\+Min\+\_\+\+Stack\+\_\+\+Size)을 침범하면 errno = ENOMEM을 설정하고 (void\texorpdfstring{$\ast$}{*})-\/1을 반환한다.
\end{DoxyItemize}

\begin{DoxyNote}{주의}
\+\_\+\+Min\+\_\+\+Stack\+\_\+\+Size가 부족하면 링커 스크립트에서 값을 늘려야 한다.
\end{DoxyNote}
\begin{DoxyAuthor}{작성자}
STMicroelectronics (Generated by STM32\+Cube\+IDE) 
\end{DoxyAuthor}
\begin{DoxyDate}{날짜}
2025
\end{DoxyDate}
\begin{DoxyAttention}{주의}
Copyright (c) 2025 STMicroelectronics. All rights reserved. 
\end{DoxyAttention}


\doxymbox{\hyperlink{sysmem_8c_source}{sysmem.\+c}} 파일에서 정의되었습니다.



\label{doc-func-members}
\Hypertarget{sysmem_8c_doc-func-members}
\doxysubsection{함수 문서화}
\Hypertarget{sysmem_8c_a68125648bcce70b6bb3aa0be50e99700}\index{sysmem.c@{sysmem.c}!\_sbrk@{\_sbrk}}
\index{\_sbrk@{\_sbrk}!sysmem.c@{sysmem.c}}
\doxysubsubsection{\texorpdfstring{\_sbrk()}{\_sbrk()}}
{\footnotesize\ttfamily \label{sysmem_8c_a68125648bcce70b6bb3aa0be50e99700} 
void \texorpdfstring{$\ast$}{*} \+\_\+sbrk (\begin{DoxyParamCaption}\item[{ptrdiff\+\_\+t}]{incr}{}\end{DoxyParamCaption})}



\doxylink{sysmem_8c_a68125648bcce70b6bb3aa0be50e99700}{\+\_\+sbrk()} allocates memory to the newlib heap and is used by malloc and others from the C library 

\begin{DoxyVerb}* ############################################################################
* #  .data  #  .bss  #       newlib heap       #          MSP stack          #
* #         #        #                         # Reserved by _Min_Stack_Size #
* ############################################################################
* ^-- RAM start      ^-- _end                             _estack, RAM end --^
* \end{DoxyVerb}


This implementation starts allocating at the \textquotesingle{}\+\_\+end\textquotesingle{} linker symbol The \textquotesingle{}\+\_\+\+Min\+\_\+\+Stack\+\_\+\+Size\textquotesingle{} linker symbol reserves a memory for the MSP stack The implementation considers \textquotesingle{}\+\_\+estack\textquotesingle{} linker symbol to be RAM end NOTE:\+ If the MSP stack, at any point during execution, grows larger than the reserved size, please increase the \textquotesingle{}\+\_\+\+Min\+\_\+\+Stack\+\_\+\+Size\textquotesingle{}.


\begin{DoxyParams}{매개변수}
{\em incr} & Memory size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
Pointer to allocated memory 
\end{DoxyReturn}


\doxymbox{\hyperlink{sysmem_8c_source}{sysmem.\+c}} 파일의 \doxymbox{\hyperlink{sysmem_8c_source_l00061}{61}} 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{00062\ \{}
\DoxyCodeLine{00063\ \ \ \textcolor{keyword}{extern}\ uint8\_t\ \_end;\ \textcolor{comment}{/*\ Symbol\ defined\ in\ the\ linker\ script\ */}}
\DoxyCodeLine{00064\ \ \ \textcolor{keyword}{extern}\ uint8\_t\ \_estack;\ \textcolor{comment}{/*\ Symbol\ defined\ in\ the\ linker\ script\ */}}
\DoxyCodeLine{00065\ \ \ \textcolor{keyword}{extern}\ uint32\_t\ \_Min\_Stack\_Size;\ \textcolor{comment}{/*\ Symbol\ defined\ in\ the\ linker\ script\ */}}
\DoxyCodeLine{00066\ \ \ \textcolor{keyword}{const}\ uint32\_t\ stack\_limit\ =\ (uint32\_t)\&\_estack\ -\/\ (uint32\_t)\&\_Min\_Stack\_Size;}
\DoxyCodeLine{00067\ \ \ \textcolor{keyword}{const}\ uint8\_t\ *max\_heap\ =\ (uint8\_t\ *)stack\_limit;}
\DoxyCodeLine{00068\ \ \ uint8\_t\ *prev\_heap\_end;}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \textcolor{comment}{/*\ Initialize\ heap\ end\ at\ first\ call\ */}}
\DoxyCodeLine{00071\ \ \ \textcolor{keywordflow}{if}\ (NULL\ ==\ \doxymbox{\hyperlink{sysmem_8c_a2cf862d604e9c7cfcf0528a0f539a6a5}{\_\_sbrk\_heap\_end}})}
\DoxyCodeLine{00072\ \ \ \{}
\DoxyCodeLine{00073\ \ \ \ \ \doxymbox{\hyperlink{sysmem_8c_a2cf862d604e9c7cfcf0528a0f539a6a5}{\_\_sbrk\_heap\_end}}\ =\ \&\_end;}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{comment}{/*\ Protect\ heap\ from\ growing\ into\ the\ reserved\ MSP\ stack\ */}}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{if}\ (\doxymbox{\hyperlink{sysmem_8c_a2cf862d604e9c7cfcf0528a0f539a6a5}{\_\_sbrk\_heap\_end}}\ +\ incr\ >\ max\_heap)}
\DoxyCodeLine{00078\ \ \ \{}
\DoxyCodeLine{00079\ \ \ \ \ errno\ =\ ENOMEM;}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{void}\ *)-\/1;}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ prev\_heap\_end\ =\ \doxymbox{\hyperlink{sysmem_8c_a2cf862d604e9c7cfcf0528a0f539a6a5}{\_\_sbrk\_heap\_end}};}
\DoxyCodeLine{00084\ \ \ \doxymbox{\hyperlink{sysmem_8c_a2cf862d604e9c7cfcf0528a0f539a6a5}{\_\_sbrk\_heap\_end}}\ +=\ incr;}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{void}\ *)prev\_heap\_end;}
\DoxyCodeLine{00087\ \}}

\end{DoxyCode}


\label{doc-var-members}
\Hypertarget{sysmem_8c_doc-var-members}
\doxysubsection{변수 문서화}
\Hypertarget{sysmem_8c_a2cf862d604e9c7cfcf0528a0f539a6a5}\index{sysmem.c@{sysmem.c}!\_\_sbrk\_heap\_end@{\_\_sbrk\_heap\_end}}
\index{\_\_sbrk\_heap\_end@{\_\_sbrk\_heap\_end}!sysmem.c@{sysmem.c}}
\doxysubsubsection{\texorpdfstring{\_\_sbrk\_heap\_end}{\_\_sbrk\_heap\_end}}
{\footnotesize\ttfamily \label{sysmem_8c_a2cf862d604e9c7cfcf0528a0f539a6a5} 
uint8\+\_\+t\texorpdfstring{$\ast$}{*} \+\_\+\+\_\+sbrk\+\_\+heap\+\_\+end = NULL\hspace{0.3cm}{\ttfamily [static]}}

Pointer to the current high watermark of the heap usage 

\doxymbox{\hyperlink{sysmem_8c_source}{sysmem.\+c}} 파일의 \doxymbox{\hyperlink{sysmem_8c_source_l00038}{38}} 번째 라인에서 정의되었습니다.

