\doxysection{adc.\+c}
\hypertarget{adc_8c_source}{}\label{adc_8c_source}\index{C:/Users/USER/OneDrive/Desktop/doxygen/RC\_DRIVER/adc.c@{C:/Users/USER/OneDrive/Desktop/doxygen/RC\_DRIVER/adc.c}}
\doxymbox{\hyperlink{adc_8c}{이 파일의 문서화 페이지로 가기}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00025}\doxymbox{\hyperlink{adc_8c_a6468e4f5307fe3787196c448082edfa4}{00025}}\ \textcolor{preprocessor}{\#define\ ADC12BIT\ \ 4095.1f\ \ }}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00026}\doxymbox{\hyperlink{adc_8c_abb6c4ee522ebd1493a24229158ba9289}{00026}}\ \textcolor{preprocessor}{\#define\ ADC\_RESOL\ ADC12BIT\ }}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00028}00028\ \textcolor{preprocessor}{\#include\ "{}adc.h"{}}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00029}00029\ \textcolor{preprocessor}{\#include\ "{}stm32g4xx\_it.h"{}}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00030}00030\ \textcolor{preprocessor}{\#include\ "{}inv.h"{}}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00036}\doxymbox{\hyperlink{group___a_d_c___variables_ga734b67f14f678f4b701be37706729cd0}{00036}}\ \textcolor{keywordtype}{int}\ \doxymbox{\hyperlink{group___a_d_c___variables_ga734b67f14f678f4b701be37706729cd0}{AdInitFlag}}\ =\ 0;\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00038}\doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{00038}}\ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{adc1Val}}[4]\ \ \ \ \ =\ \{0.f,\ 0.f,\ 0.f,\ 0.f\};\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00039}\doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{00039}}\ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[4]\ =\ \{0.f,\ 0.f,\ 0.f,\ 0.f\};\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00041}\doxymbox{\hyperlink{group___a_d_c___variables_gaaf7ce8ada81ed29a8dc65c3e5e37dc9f}{00041}}\ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{group___a_d_c___variables_gaaf7ce8ada81ed29a8dc65c3e5e37dc9f}{ADC1\_Offset}}[3]\ \ \ \ \ \ \ \ \ \ \ \ \ =\ \{2048.f,\ 2048.f,\ 2048.f\};\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00042}\doxymbox{\hyperlink{group___a_d_c___variables_gad15e099727465664d340076de7f99b54}{00042}}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \doxymbox{\hyperlink{group___a_d_c___variables_gad15e099727465664d340076de7f99b54}{ADC1\_Offset\_sum}}[3]\ =\ \{0,\ 0,\ 0\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00044}\doxymbox{\hyperlink{group___a_d_c___variables_ga179af1226d9481eedeaa735e688c4553}{00044}}\ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{group___a_d_c___variables_ga179af1226d9481eedeaa735e688c4553}{scale\_comp}}\ =\ 1.0f;\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00050}\doxymbox{\hyperlink{group___a_d_c___variables_ga30578536ba1b4f97bf46c3e23a4656af}{00050}}\ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{group___a_d_c___variables_ga30578536ba1b4f97bf46c3e23a4656af}{ADCgain}}[4]\ =\ \{1.0f,\ 1.0f,\ 1.0f,\ 1.0f\};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00052}\doxymbox{\hyperlink{group___a_d_c___variables_gaa84d1b34b367ee7ae68cfdb9161260cc}{00052}}\ \textcolor{keywordtype}{float}\ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gaa84d1b34b367ee7ae68cfdb9161260cc}{Ia\_arr}}[3000];\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00053}\doxymbox{\hyperlink{group___a_d_c___variables_ga62322c9b26bf52d62a48597667468e2e}{00053}}\ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_ga62322c9b26bf52d62a48597667468e2e}{store\_cnt}}\ \ =\ 0;\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00054}\doxymbox{\hyperlink{group___a_d_c___variables_gaefc0d46c6253b25ffa506d5430abe433}{00054}}\ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gaefc0d46c6253b25ffa506d5430abe433}{store\_flag}}\ =\ 0;\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00055}\doxymbox{\hyperlink{group___a_d_c___variables_ga263585f5810892154827fe50fa03970f}{00055}}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \doxymbox{\hyperlink{group___a_d_c___variables_ga263585f5810892154827fe50fa03970f}{AdOffCalcCnt}}\ =\ 0;\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00059}\doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{00059}}\ ADC\_HandleTypeDef\ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}};\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00072}\doxymbox{\hyperlink{adc_8c_acccd58aa70215a6b184ad242312ffd0c}{00072}}\ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{adc_8c_acccd58aa70215a6b184ad242312ffd0c}{MX\_ADC1\_Init}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00073}00073\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00074}00074\ \ \ \ \ ADC\_MultiModeTypeDef\ \ \ \ \ multimode\ \ \ \ \ \ \ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00075}00075\ \ \ \ \ ADC\_ChannelConfTypeDef\ \ \ sConfig\ \ \ \ \ \ \ \ \ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00076}00076\ \ \ \ \ ADC\_InjectionConfTypeDef\ sConfigInjected\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00078}00078\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Instance\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ ADC1;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00079}00079\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.ClockPrescaler\ \ \ \ \ \ \ \ =\ ADC\_CLOCK\_SYNC\_PCLK\_DIV4;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00080}00080\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.Resolution\ \ \ \ \ \ \ \ \ \ \ \ =\ ADC\_RESOLUTION\_12B;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00081}00081\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.DataAlign\ \ \ \ \ \ \ \ \ \ \ \ \ =\ ADC\_DATAALIGN\_RIGHT;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00082}00082\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.GainCompensation\ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00083}00083\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.ScanConvMode\ \ \ \ \ \ \ \ \ \ =\ ADC\_SCAN\_ENABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00084}00084\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.EOCSelection\ \ \ \ \ \ \ \ \ \ =\ ADC\_EOC\_SINGLE\_CONV;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00085}00085\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.LowPowerAutoWait\ \ \ \ \ \ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00086}00086\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.ContinuousConvMode\ \ \ \ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00087}00087\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.NbrOfConversion\ \ \ \ \ \ \ =\ 1;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00088}00088\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.DiscontinuousConvMode\ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00089}00089\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.ExternalTrigConv\ \ \ \ \ \ =\ ADC\_SOFTWARE\_START;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00090}00090\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.ExternalTrigConvEdge\ \ =\ ADC\_EXTERNALTRIGCONVEDGE\_NONE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00091}00091\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.DMAContinuousRequests\ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00092}00092\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.Overrun\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ ADC\_OVR\_DATA\_PRESERVED;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00093}00093\ \ \ \ \ \doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}}.Init.OversamplingMode\ \ \ \ \ \ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00094}00094\ \ \ \ \ \textcolor{keywordflow}{if}\ (HAL\_ADC\_Init(\&\doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}})\ !=\ HAL\_OK)\ \{\ \doxymbox{\hyperlink{main_8c_a1730ffe1e560465665eb47d9264826f9}{Error\_Handler}}();\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00096}00096\ \ \ \ \ multimode.Mode\ =\ ADC\_MODE\_INDEPENDENT;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00097}00097\ \ \ \ \ \textcolor{keywordflow}{if}\ (HAL\_ADCEx\_MultiModeConfigChannel(\&\doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}},\ \&multimode)\ !=\ HAL\_OK)\ \{\ \doxymbox{\hyperlink{main_8c_a1730ffe1e560465665eb47d9264826f9}{Error\_Handler}}();\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00099}00099\ \ \ \ \ \textcolor{comment}{/*\ Regular\ CH1\ (초기화만\ 수행)\ */}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00100}00100\ \ \ \ \ sConfig.Channel\ \ \ \ \ \ =\ ADC\_CHANNEL\_1;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00101}00101\ \ \ \ \ sConfig.Rank\ \ \ \ \ \ \ \ \ =\ ADC\_REGULAR\_RANK\_1;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00102}00102\ \ \ \ \ sConfig.SamplingTime\ =\ ADC\_SAMPLETIME\_2CYCLES\_5;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00103}00103\ \ \ \ \ sConfig.SingleDiff\ \ \ =\ ADC\_SINGLE\_ENDED;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00104}00104\ \ \ \ \ sConfig.OffsetNumber\ =\ ADC\_OFFSET\_NONE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00105}00105\ \ \ \ \ sConfig.Offset\ \ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00106}00106\ \ \ \ \ \textcolor{keywordflow}{if}\ (HAL\_ADC\_ConfigChannel(\&\doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}},\ \&sConfig)\ !=\ HAL\_OK)\ \{\ \doxymbox{\hyperlink{main_8c_a1730ffe1e560465665eb47d9264826f9}{Error\_Handler}}();\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00108}00108\ \ \ \ \ \textcolor{comment}{/*\ Injected\ CH1\string~CH3\ (Ia/Ib/Ic):\ TIM2\ TRGO\ 트리거\ */}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00109}00109\ \ \ \ \ sConfigInjected.InjectedChannel\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ ADC\_CHANNEL\_1;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00110}00110\ \ \ \ \ sConfigInjected.InjectedRank\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ ADC\_INJECTED\_RANK\_1;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00111}00111\ \ \ \ \ sConfigInjected.InjectedSamplingTime\ \ \ \ \ \ \ \ \ \ =\ ADC\_SAMPLETIME\_2CYCLES\_5;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00112}00112\ \ \ \ \ sConfigInjected.InjectedSingleDiff\ \ \ \ \ \ \ \ \ \ \ \ =\ ADC\_SINGLE\_ENDED;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00113}00113\ \ \ \ \ sConfigInjected.InjectedOffsetNumber\ \ \ \ \ \ \ \ \ \ =\ ADC\_OFFSET\_NONE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00114}00114\ \ \ \ \ sConfigInjected.InjectedOffset\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00115}00115\ \ \ \ \ sConfigInjected.InjectedNbrOfConversion\ \ \ \ \ \ \ =\ 4;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00116}00116\ \ \ \ \ sConfigInjected.InjectedDiscontinuousConvMode\ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00117}00117\ \ \ \ \ sConfigInjected.AutoInjectedConv\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00118}00118\ \ \ \ \ sConfigInjected.QueueInjectedContext\ \ \ \ \ \ \ \ \ \ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00119}00119\ \ \ \ \ sConfigInjected.ExternalTrigInjecConv\ \ \ \ \ \ \ \ \ =\ ADC\_EXTERNALTRIGINJEC\_T2\_TRGO;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00120}00120\ \ \ \ \ sConfigInjected.ExternalTrigInjecConvEdge\ \ \ \ \ =\ ADC\_EXTERNALTRIGINJECCONV\_EDGE\_RISING;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00121}00121\ \ \ \ \ sConfigInjected.InjecOversamplingMode\ \ \ \ \ \ \ \ \ =\ DISABLE;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00122}00122\ \ \ \ \ \textcolor{keywordflow}{if}\ (HAL\_ADCEx\_InjectedConfigChannel(\&\doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}},\ \&sConfigInjected)\ !=\ HAL\_OK)\ \{\ \doxymbox{\hyperlink{main_8c_a1730ffe1e560465665eb47d9264826f9}{Error\_Handler}}();\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00124}00124\ \ \ \ \ sConfigInjected.InjectedChannel\ =\ ADC\_CHANNEL\_2;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00125}00125\ \ \ \ \ sConfigInjected.InjectedRank\ \ \ \ =\ ADC\_INJECTED\_RANK\_2;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00126}00126\ \ \ \ \ \textcolor{keywordflow}{if}\ (HAL\_ADCEx\_InjectedConfigChannel(\&\doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}},\ \&sConfigInjected)\ !=\ HAL\_OK)\ \{\ \doxymbox{\hyperlink{main_8c_a1730ffe1e560465665eb47d9264826f9}{Error\_Handler}}();\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00128}00128\ \ \ \ \ sConfigInjected.InjectedChannel\ =\ ADC\_CHANNEL\_3;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00129}00129\ \ \ \ \ sConfigInjected.InjectedRank\ \ \ \ =\ ADC\_INJECTED\_RANK\_3;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00130}00130\ \ \ \ \ \textcolor{keywordflow}{if}\ (HAL\_ADCEx\_InjectedConfigChannel(\&\doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}},\ \&sConfigInjected)\ !=\ HAL\_OK)\ \{\ \doxymbox{\hyperlink{main_8c_a1730ffe1e560465665eb47d9264826f9}{Error\_Handler}}();\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00132}00132\ \ \ \ \ \textcolor{comment}{/*\ Injected\ CH4\ (Vdc):\ 47.5\ 사이클\ 샘플링\ */}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00133}00133\ \ \ \ \ sConfigInjected.InjectedChannel\ \ \ \ \ \ =\ ADC\_CHANNEL\_4;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00134}00134\ \ \ \ \ sConfigInjected.InjectedRank\ \ \ \ \ \ \ \ \ =\ ADC\_INJECTED\_RANK\_4;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00135}00135\ \ \ \ \ sConfigInjected.InjectedSamplingTime\ =\ ADC\_SAMPLETIME\_47CYCLES\_5;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00136}00136\ \ \ \ \ \textcolor{keywordflow}{if}\ (HAL\_ADCEx\_InjectedConfigChannel(\&\doxymbox{\hyperlink{adc_8c_a22b804736f5648d52f639b2647d4ed13}{hadc1}},\ \&sConfigInjected)\ !=\ HAL\_OK)\ \{\ \doxymbox{\hyperlink{main_8c_a1730ffe1e560465665eb47d9264826f9}{Error\_Handler}}();\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00137}00137\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00147}\doxymbox{\hyperlink{adc_8c_ac3139540667c403c5dfd37a99c610b1c}{00147}}\ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{adc_8c_ac3139540667c403c5dfd37a99c610b1c}{HAL\_ADC\_MspInit}}(ADC\_HandleTypeDef\ *adcHandle)}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00148}00148\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00149}00149\ \ \ \ \ GPIO\_InitTypeDef\ \ \ \ \ \ \ \ \ GPIO\_InitStruct\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00150}00150\ \ \ \ \ RCC\_PeriphCLKInitTypeDef\ PeriphClkInit\ \ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00152}00152\ \ \ \ \ \textcolor{keywordflow}{if}\ (adcHandle-\/>Instance\ ==\ ADC1)}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00153}00153\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00154}00154\ \ \ \ \ \ \ \ \ PeriphClkInit.PeriphClockSelection\ =\ RCC\_PERIPHCLK\_ADC12;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00155}00155\ \ \ \ \ \ \ \ \ PeriphClkInit.Adc12ClockSelection\ \ =\ RCC\_ADC12CLKSOURCE\_SYSCLK;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00156}00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (HAL\_RCCEx\_PeriphCLKConfig(\&PeriphClkInit)\ !=\ HAL\_OK)\ \{\ \doxymbox{\hyperlink{main_8c_a1730ffe1e560465665eb47d9264826f9}{Error\_Handler}}();\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00158}00158\ \ \ \ \ \ \ \ \ \_\_HAL\_RCC\_ADC12\_CLK\_ENABLE();}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00159}00159\ \ \ \ \ \ \ \ \ \_\_HAL\_RCC\_GPIOA\_CLK\_ENABLE();}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00161}00161\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ PA0=Ia,\ PA1=Ib,\ PA2=Ic,\ PA3=Vdc:\ 아날로그\ 입력\ */}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00162}00162\ \ \ \ \ \ \ \ \ GPIO\_InitStruct.Pin\ \ =\ GPIO\_PIN\_0\ |\ GPIO\_PIN\_1\ |\ GPIO\_PIN\_2\ |\ GPIO\_PIN\_3;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00163}00163\ \ \ \ \ \ \ \ \ GPIO\_InitStruct.Mode\ =\ GPIO\_MODE\_ANALOG;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00164}00164\ \ \ \ \ \ \ \ \ GPIO\_InitStruct.Pull\ =\ GPIO\_NOPULL;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00165}00165\ \ \ \ \ \ \ \ \ HAL\_GPIO\_Init(GPIOA,\ \&GPIO\_InitStruct);}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00167}00167\ \ \ \ \ \ \ \ \ HAL\_NVIC\_SetPriority(ADC1\_2\_IRQn,\ 0,\ 0);}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00168}00168\ \ \ \ \ \ \ \ \ HAL\_NVIC\_EnableIRQ(ADC1\_2\_IRQn);}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00169}00169\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00170}00170\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00177}\doxymbox{\hyperlink{adc_8c_a3f61f2c2af0f122f81a87af8ad7b4360}{00177}}\ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{adc_8c_a3f61f2c2af0f122f81a87af8ad7b4360}{HAL\_ADC\_MspDeInit}}(ADC\_HandleTypeDef\ *adcHandle)}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00178}00178\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00179}00179\ \ \ \ \ \textcolor{keywordflow}{if}\ (adcHandle-\/>Instance\ ==\ ADC1)}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00180}00180\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00181}00181\ \ \ \ \ \ \ \ \ \_\_HAL\_RCC\_ADC12\_CLK\_DISABLE();}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00182}00182\ \ \ \ \ \ \ \ \ HAL\_GPIO\_DeInit(GPIOA,\ GPIO\_PIN\_0\ |\ GPIO\_PIN\_1\ |\ GPIO\_PIN\_2\ |\ GPIO\_PIN\_3);}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00183}00183\ \ \ \ \ \ \ \ \ HAL\_NVIC\_DisableIRQ(ADC1\_2\_IRQn);}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00184}00184\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00185}00185\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00186}00186\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00197}\doxymbox{\hyperlink{adc_8c_a39fd8940b1565d6d40f65b288f358c6c}{00197}}\ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{adc_8c_a39fd8940b1565d6d40f65b288f358c6c}{AdcProcess}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00198}00198\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00199}00199\ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[0]\ =\ (\doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{adc1Val}}[0]\ -\/\ \doxymbox{\hyperlink{group___a_d_c___variables_gaaf7ce8ada81ed29a8dc65c3e5e37dc9f}{ADC1\_Offset}}[0])\ /\ 81.9f;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00200}00200\ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[1]\ =\ (\doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{adc1Val}}[1]\ -\/\ \doxymbox{\hyperlink{group___a_d_c___variables_gaaf7ce8ada81ed29a8dc65c3e5e37dc9f}{ADC1\_Offset}}[1])\ /\ 81.9f;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00201}00201\ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[2]\ =\ (\doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{adc1Val}}[2]\ -\/\ \doxymbox{\hyperlink{group___a_d_c___variables_gaaf7ce8ada81ed29a8dc65c3e5e37dc9f}{ADC1\_Offset}}[2])\ /\ 81.9f;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00202}00202\ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[3]\ =\ \ \doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{adc1Val}}[3]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ /\ 203.4f;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00203}00203\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00204}00204\ \ \ \ \ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Ia\ \ =\ \doxymbox{\hyperlink{group___a_d_c___variables_ga30578536ba1b4f97bf46c3e23a4656af}{ADCgain}}[0]\ *\ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[0]\ *\ \doxymbox{\hyperlink{group___a_d_c___variables_ga179af1226d9481eedeaa735e688c4553}{scale\_comp}};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00205}00205\ \ \ \ \ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Ib\ \ =\ \doxymbox{\hyperlink{group___a_d_c___variables_ga30578536ba1b4f97bf46c3e23a4656af}{ADCgain}}[1]\ *\ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[1]\ *\ \doxymbox{\hyperlink{group___a_d_c___variables_ga179af1226d9481eedeaa735e688c4553}{scale\_comp}};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00206}00206\ \ \ \ \ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Ic\ \ =\ \doxymbox{\hyperlink{group___a_d_c___variables_ga30578536ba1b4f97bf46c3e23a4656af}{ADCgain}}[2]\ *\ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[2]\ *\ \doxymbox{\hyperlink{group___a_d_c___variables_ga179af1226d9481eedeaa735e688c4553}{scale\_comp}};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00207}00207\ \ \ \ \ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Vdc\ =\ \doxymbox{\hyperlink{group___a_d_c___variables_ga30578536ba1b4f97bf46c3e23a4656af}{ADCgain}}[3]\ *\ \doxymbox{\hyperlink{group___a_d_c___variables_ga7a716cd4960c2c53daedb424e347c545}{ADC1\_Result}}[3]\ *\ \doxymbox{\hyperlink{group___a_d_c___variables_ga179af1226d9481eedeaa735e688c4553}{scale\_comp}};}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00209}00209\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ alpha\ =\ 0.999f;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00210}00210\ \ \ \ \ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Vdc\_control\ \ \ =\ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Vdc\ *\ (1.0f\ -\/\ alpha)\ +\ alpha\ *\ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Vdc\_control;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00211}00211\ \ \ \ \ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Vdc\ \ \ \ \ \ \ \ \ \ \ =\ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Vdc\_control;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00212}00212\ \ \ \ \ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.INV\_Vdc\ \ \ \ \ \ \ =\ 1.0f\ /\ MAX(\doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Vdc\_control,\ 1.f);}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00214}00214\ \ \ \ \ \textcolor{keywordflow}{if}\ (\doxymbox{\hyperlink{group___a_d_c___variables_gaefc0d46c6253b25ffa506d5430abe433}{store\_flag}}\ ==\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00215}00215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\doxymbox{\hyperlink{group___a_d_c___variables_ga62322c9b26bf52d62a48597667468e2e}{store\_cnt}}\ <\ 3000)\ \doxymbox{\hyperlink{group___a_d_c___variables_gaa84d1b34b367ee7ae68cfdb9161260cc}{Ia\_arr}}[\doxymbox{\hyperlink{group___a_d_c___variables_ga62322c9b26bf52d62a48597667468e2e}{store\_cnt}}++]\ =\ \doxymbox{\hyperlink{inv_8c_a5b799dff3aee9e48ae67cfe1f9075e30}{INV}}.Ia;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00216}00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gaefc0d46c6253b25ffa506d5430abe433}{store\_flag}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00217}00217\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00218}00218\ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00219}00219\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00230}\doxymbox{\hyperlink{adc_8c_a5c5c41c37d32d75b9a5844f877762629}{00230}}\ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{adc_8c_a5c5c41c37d32d75b9a5844f877762629}{Offset}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00231}00231\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00232}00232\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ AdDummyCnt\ =\ 0;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00233}00233\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00234}00234\ \ \ \ \ \textcolor{keywordflow}{if}\ (AdDummyCnt\ <\ 5000)\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00235}00235\ \ \ \ \ \ \ \ \ AdDummyCnt++;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00236}00236\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00237}00237\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_ga263585f5810892154827fe50fa03970f}{AdOffCalcCnt}}++;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00238}00238\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00239}00239\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gad15e099727465664d340076de7f99b54}{ADC1\_Offset\_sum}}[0]\ +=\ (\textcolor{keywordtype}{unsigned}\ long)\doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{adc1Val}}[0];}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00240}00240\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gad15e099727465664d340076de7f99b54}{ADC1\_Offset\_sum}}[1]\ +=\ (\textcolor{keywordtype}{unsigned}\ long)\doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{adc1Val}}[1];}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00241}00241\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gad15e099727465664d340076de7f99b54}{ADC1\_Offset\_sum}}[2]\ +=\ (\textcolor{keywordtype}{unsigned}\ long)\doxymbox{\hyperlink{group___a_d_c___variables_ga3f46ad79f65150aec6105a862cf32624}{adc1Val}}[2];}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00242}00242\ }
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00243}00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\doxymbox{\hyperlink{group___a_d_c___variables_ga263585f5810892154827fe50fa03970f}{AdOffCalcCnt}}\ ==\ 5000)\ \{}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gaaf7ce8ada81ed29a8dc65c3e5e37dc9f}{ADC1\_Offset}}[0]\ =\ (float)\doxymbox{\hyperlink{group___a_d_c___variables_gad15e099727465664d340076de7f99b54}{ADC1\_Offset\_sum}}[0]\ /\ 5000.f;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gaaf7ce8ada81ed29a8dc65c3e5e37dc9f}{ADC1\_Offset}}[1]\ =\ (float)\doxymbox{\hyperlink{group___a_d_c___variables_gad15e099727465664d340076de7f99b54}{ADC1\_Offset\_sum}}[1]\ /\ 5000.f;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_gaaf7ce8ada81ed29a8dc65c3e5e37dc9f}{ADC1\_Offset}}[2]\ =\ (float)\doxymbox{\hyperlink{group___a_d_c___variables_gad15e099727465664d340076de7f99b54}{ADC1\_Offset\_sum}}[2]\ /\ 5000.f;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{group___a_d_c___variables_ga734b67f14f678f4b701be37706729cd0}{AdInitFlag}}\ =\ 1;}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00248}00248\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00249}00249\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{adc_8c_source_l00250}00250\ \}}

\end{DoxyCode}
